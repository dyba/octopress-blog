
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Daniel Dyba</title>
  <meta name="author" content="Daniel Dyba">

  
  <meta name="description" content="The ExerciseIn lesson 5 of RubyMonk.com, there&#8217;s an exercise with the following objective:to capitalize the first character of each part of t...">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://danieldyba.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Daniel Dyba" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Daniel Dyba</a></h1>
  
    <h2>Rails Developer, Programming Linguaphile</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:danieldyba.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/13/ruby-monk-problem-capitalizing-an-array-of-names/">Ruby Monk Problem - Capitalizing an Array of Names</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-11-13T12:09:00-08:00" pubdate  data-updated="true" >Nov 13<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/11/13/ruby-monk-problem-capitalizing-an-array-of-names/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>The Exercise</h2>

<p>In lesson 5 of <a href="http://rubymonk.com">RubyMonk.com</a>, there&#8217;s an exercise with the following objective:</p>

<blockquote><p>to capitalize the first character of each part of the name as it combined them.</p></blockquote>


<p>The code they provide is:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># bust out a beefy reduce on this bad boy:</span>
</span><span class='line'><span class="o">[</span><span class="s2">&quot;emperor&quot;</span><span class="p">,</span> <span class="s2">&quot;joshua&quot;</span><span class="p">,</span> <span class="s2">&quot;abraham&quot;</span><span class="p">,</span> <span class="s2">&quot;norton&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>First Attempt</h3>

<p>I worked out the code below but then realized it didn&#8217;t solve the problem.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="s2">&quot;emperor&quot;</span><span class="p">,</span> <span class="s2">&quot;joshua&quot;</span><span class="p">,</span> <span class="s2">&quot;abraham&quot;</span><span class="p">,</span> <span class="s2">&quot;norton&quot;</span><span class="o">].</span><span class="n">inject</span> <span class="k">do</span> <span class="o">|</span><span class="n">full_name</span><span class="p">,</span> <span class="nb">name</span><span class="o">|</span>
</span><span class='line'>  <span class="s2">&quot;</span><span class="si">#{</span><span class="n">full_name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="nb">name</span><span class="o">.</span><span class="n">capitalize</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This ends up with <code>"emperor Joshua Abraham Norton"</code>. I didn&#8217;t capitalize the first word <code>emperor</code>.</p>

<h3>Second Attempt</h3>

<p>Ok, no problem. I&#8217;ll just capitalize <code>full_name</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="s2">&quot;emperor&quot;</span><span class="p">,</span> <span class="s2">&quot;joshua&quot;</span><span class="p">,</span> <span class="s2">&quot;abraham&quot;</span><span class="p">,</span> <span class="s2">&quot;norton&quot;</span><span class="o">].</span><span class="n">inject</span> <span class="k">do</span> <span class="o">|</span><span class="n">full_name</span><span class="p">,</span> <span class="nb">name</span><span class="o">|</span>
</span><span class='line'>  <span class="s2">&quot;</span><span class="si">#{</span><span class="n">full_name</span><span class="o">.</span><span class="n">capitalize</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="nb">name</span><span class="o">.</span><span class="n">capitalize</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>No. You can&#8217;t do that. That will end up capitalizing just the first word <code>emperor</code>. You will end up with <code>"Emperor joshua abraham Norton"</code>. The reason is the block variable <code>full_name</code> remembers the last value calculated inside the block. Because we did not pass an initial value to the inject method, it uses the first value in your collection by default, in this case <code>"emperor"</code>. Inside the body of the block, we take <code>"emperor"</code> and capitalize it followed by <code>"joshua"</code> and capitalize that. We put the two together to get the complete string <code>"Emperor Joshua"</code>. You can try this out in irb by truncating your array to just two elements, <code>["emperor", "joshua"]</code>.</p>

<p>So far so good. Next, we use this result of the calculation carried out in the body of the block and pass it to the block variable <code>full_name</code>. The block variable <code>name</code> is set to the next item in our collection, which is <code>"abraham"</code>. We run through the body of the block again which leads us to capitalize <code>"Emperor Joshua"</code> and <code>"abraham"</code>. That gives us <code>"Emperor joshua"</code> and <code>"Abraham"</code>. That&#8217;s where things go wrong. When you <code>capitalize</code> a string, you are putting all characters except the first character in their lower case form.</p>

<h3>A Hack</h3>

<p>How then, do you capitalize the first name? By default, <code>inject</code> will use <code>"emperor"</code> as its initial value since I have passed no parameter to the <code>inject</code> method. What if I did try to pass in a parameter? What would that parameter be? What if I passed in an empty string? Ah, in that case, the <code>full_name</code> will be equal to <code>''</code>, the empty string.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="s2">&quot;emperor&quot;</span><span class="p">,</span> <span class="s2">&quot;joshua&quot;</span><span class="p">,</span> <span class="s2">&quot;abraham&quot;</span><span class="p">,</span> <span class="s2">&quot;norton&quot;</span><span class="o">].</span><span class="n">inject</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">full_name</span><span class="p">,</span> <span class="nb">name</span><span class="o">|</span>
</span><span class='line'>  <span class="s2">&quot;</span><span class="si">#{</span><span class="n">full_name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="nb">name</span><span class="o">.</span><span class="n">capitalize</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">strip</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>If I only made a call to <code>"#{full_name} #{name.capitalize}"</code>, I would have an extra space in front of the name, <code>" Emperor Joshua Abraham Norton"</code>, by the time block iterated through all the items in the array. To get rid of this, I just <code>strip</code> the whitespace. Do you have another of solving this problem with the constraint of using the <code>inject</code> method? I&#8217;d love to hear your ideas.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/11/karate-chop-code-kata-second-run/">Karate Chop Code Kata - Second Run</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-11-11T12:41:00-08:00" pubdate  data-updated="true" >Nov 11<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/11/11/karate-chop-code-kata-second-run/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Several Attempts With No Solution In Sight</h2>

<p>The second run at implementing the binary chop method was excruciating. After several attempts, I finally decided to check out what others were doing. Was I blinded to a particular kind of solution I had in mind? Was my understanding of recursion incorrect? I felt I probably had a blind spot that was keeping me from seeing the problem in a new way. After going out on a Google search for the solution, I came across <a href="http://softwareramblings.com/2009/11/codekata-kata-two-solution.html">Stephen Doyle&#8217;s Blog</a></p>

<p>Here is his solution:</p>

<figure class='code'><figcaption><span>Stephen Doyle&#8217;s Solution</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">chop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
</span><span class='line'>  <span class="c1"># Special handling for zero and single element arrays</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">empty?</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="p">((</span><span class="n">target</span> <span class="o">==</span> <span class="n">values</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">)</span> <span class="p">?</span> <span class="mi">0</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">length</span> <span class="o">==</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Try the bottom half first</span>
</span><span class='line'>  <span class="n">pos</span> <span class="o">=</span> <span class="nb">chop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">values</span><span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">length</span><span class="o">/</span><span class="mi">2</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">pos</span> <span class="k">if</span> <span class="n">pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Then the upper half ... remember that the returned</span>
</span><span class='line'>  <span class="c1"># position is relative to the middle of the array.</span>
</span><span class='line'>  <span class="n">pos</span> <span class="o">=</span> <span class="nb">chop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">values</span><span class="o">[</span><span class="n">values</span><span class="o">.</span><span class="n">length</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">pos</span> <span class="o">+</span> <span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">length</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Didn&#39;t find what we were looking for</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Since I didn&#8217;t solve this, I&#8217;m going to talk about some of the approaches I took while trying to solve this problem and why they failed.</p>

<h2>My Failed Ideas</h2>

<h3>The Tweaking Approach</h3>

<p>I solved the problem once. What if I reused the same ideas but changed things just a bit? Here is what I came up with.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">defchop</span><span class="p">(</span><span class="n">int</span><span class="p">,</span><span class="n">array_of_int</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">array_of_int</span><span class="o">.</span><span class="n">empty?</span>
</span><span class='line'>
</span><span class='line'>  <span class="vi">@max</span> <span class="o">||=</span> <span class="n">array_of_int</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'>  <span class="vi">@min</span> <span class="o">||=</span> <span class="mi">0</span>
</span><span class='line'>  <span class="vi">@mid</span> <span class="o">||=</span> <span class="vi">@max</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="vi">@min</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="vi">@mid</span> <span class="k">if</span> <span class="n">int</span> <span class="o">==</span> <span class="n">array_of_int</span><span class="o">[</span><span class="vi">@mid</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="vi">@mid</span> <span class="o">==</span> <span class="vi">@max</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="n">int</span> <span class="o">&lt;</span> <span class="n">array_of_int</span><span class="o">[</span><span class="vi">@mid</span><span class="o">]</span>
</span><span class='line'>    <span class="vi">@max</span> <span class="o">=</span> <span class="vi">@mid</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="vi">@min</span> <span class="o">=</span> <span class="vi">@mid</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="nb">chop</span><span class="p">(</span><span class="n">int</span><span class="p">,</span><span class="n">array_of_int</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you can see, it uses the same idea of markers to indicate which portion of the array I am focusing on. The problem was I used instance variables to maintain state in subsequent calls to the chop method. This was a bad idea because it gave me bogus results in between assertions in my test suite. So I had to do away with instance variables as a way to maintain state.</p>

<h3>The If-Else Construct Approach</h3>

<p>You can see that from the above attempt, I continued using the if-else construct to determine which path to take in order to find the index of the integer. I used this for EVERY solution thereafter. That If-Else construct stuck to me like a leech. I didn&#8217;t even think of the possibility of doing away with it because I thought that was the only way you could traverse a binary tree. One approach I didn&#8217;t consider was simply picking one half of the array and carrying out the search until you find nothing; only then would you search for the other half. I kept thinking I MUST know whether it is greater or smaller than the integer found at the midpoint of the array. Later in this post, I discuss why I got stuck to the if-else construct approach.</p>

<h2>My Successful Ideas</h2>

<p>Even as I was making several attempts at the solution, there was one approach I took that led me closer to the solution.</p>

<h3>Passing Smaller Array Slices Approach</h3>

<p>What I did figure out was that I needed to call the chop method and pass it a smaller slice of the array. If the integer was less than the integer I found at the midpoint, I would call the chop method like so:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">chop</span> <span class="p">(</span><span class="n">int</span><span class="p">,</span> <span class="n">array</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.mid</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>If the integer was greater than the integer I found at the midpoint, I would call the chop method like so:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">chop</span><span class="p">(</span><span class="n">int</span><span class="p">,</span> <span class="n">array</span><span class="o">[</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This approach is one which Stephen Doyle used when solving the problem with recursion. I was on the right track.</p>

<h2>The Missing Links</h2>

<p>Stepping back and seeing Doyle&#8217;s recursive solution, I noticed there were a few things I didn&#8217;t understand which hampered my progress toward a solution.</p>

<h3>Just Pick a Slice!</h3>

<p>I didn&#8217;t even know this would have been allowed as part of the spec. Below is a quote from Dave Thomas&#8217; CodeKata website:</p>

<blockquote><p>A binary chop (sometimes called the more prosaic binary search) finds the position of value in a sorted array of values. It achieves some efficiency by halving the number of items under consideration each time it probes the values: in the first pass it determines whether the required value is in the top or the bottom half of the list of values. In the second pass in considers only this half, again dividing it in to two. It stops when it finds the value it is looking for, or when it runs out of array to search.</p></blockquote>


<p>What I zeroed in on was this:</p>

<blockquote><p>&#8230;in the first pass it determines whether the required value is in the top of bottom half of the list of values</p></blockquote>


<p>I thought that the implementation involved the decision-making logic of an if-else construct where you would check if the required value is in the top half or bottom half of the list of values. That was my train of thought. But nowhere in that sentence does it say you have to use an if-else construct. To me, the sentence is misleading. Perhaps I read too much into it which ultimately led to my brain focusing on solutions that only used if-else constructs.</p>

<p>Stephen&#8217;s solution involves picking the bottom slice first. If the integer is not in the bottom slice, then the logic will go on to check the top slice until it finds the integer or returns a <code>-1</code> to indicate it found no matching integer.</p>

<h2>The Solution</h2>

<p>There are a few things I would change in Stephen&#8217;s solution to make things a little more concise. Here is my solution:</p>

<figure class='code'><figcaption><span>Karate Chop Code Kata - Second Run </span><a href='https://github.com/dyba/katas-samples/blob/master/karate_chop/karate_chop_2.rb'>See on Github</a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">chop</span><span class="p">(</span><span class="n">int</span><span class="p">,</span> <span class="n">array_of_int</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">array_of_int</span><span class="o">.</span><span class="n">empty?</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mid</span> <span class="o">=</span> <span class="n">array_of_int</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="mi">2</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="p">((</span><span class="n">int</span> <span class="o">==</span> <span class="n">array_of_int</span><span class="o">[</span><span class="n">mid</span><span class="o">]</span><span class="p">)</span> <span class="p">?</span> <span class="n">mid</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">array_of_int</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">pos</span> <span class="o">=</span> <span class="nb">chop</span><span class="p">(</span><span class="n">int</span><span class="p">,</span> <span class="n">array_of_int</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">mid</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">pos</span> <span class="k">if</span> <span class="n">pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">pos</span> <span class="o">=</span> <span class="nb">chop</span><span class="p">(</span><span class="n">int</span><span class="p">,</span> <span class="n">array_of_int</span><span class="o">[</span><span class="n">mid</span><span class="o">.</span><span class="n">.</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">mid</span> <span class="k">if</span> <span class="n">pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Stephen&#8217;s solution starts by checking the 0 index of the array. I went ahead and started in the middle. Also, by defining the midpoint with the <code>mid</code> variable, I can condense the portion of the array I pass to the chop method. I also went ahead and used ranges instead of the comma syntax inside the brackets. Rather than use <code>array_of_int[array_of_int / 2, array_of_int.size - 1]</code>, I preferred the use of ranges and negative indexing to shorten the parameter I pass.</p>

<h2>A Final Note</h2>

<p>Dave Thomas hints at a third solution:</p>

<blockquote><p>&#8230;one might use a functional style passing array slices around&#8230;</p></blockquote>


<p>Let&#8217;s see how well I fare solving it in that style.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/07/karate-chop-code-kata-first-run/">Karate Chop Code Kata - First Run</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-11-07T18:40:00-08:00" pubdate  data-updated="true" >Nov 7<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/11/07/karate-chop-code-kata-first-run/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>The Idea</h2>

<p>Here is my first attempt at Code Kata #2 - Karate Chop, which is an exercise you can find on Dave Thomas&#8217; website <a href="http://codekata.pragprog.com/2007/01/kata_two_karate.html">Code Kata</a>. Now mind you, I never had a formal introduction to computer algorithms. I had to look at a computer algorithms book to make sure I understood what was meant by the term binary search routine. The idea behind Karate Chop is to write a binary search routine that takes an integer and an array, splits the array in two, determines which half of the array the integer should be on and repeats the process until it finds the integer and returns it or doesn&#8217;t find it and returns a <code>-1</code>. In the end I should have a function that can be described as follows:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">chop</span><span class="p">(</span><span class="n">integer</span><span class="p">,</span> <span class="n">array_of_integers</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">integer</span>
</span></code></pre></td></tr></table></div></figure>


<p>The integer it returns should be the index of the array in which I found the matching number. In the event that I do not find the integer in the array, I should get a <code>-1</code>.</p>

<h2>The Solution</h2>

<figure class='code'><figcaption><span>Karate Chop Code Kata - First Run </span><a href='https://github.com/dyba/katas-samples/blob/master/karate_chop/karate_chop.rb'>See On Github</a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">chop</span><span class="p">(</span><span class="n">int</span><span class="p">,</span><span class="n">array_of_int</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">array_of_int</span><span class="o">.</span><span class="n">empty?</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">min</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">array_of_int</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'>  <span class="n">midpoint</span> <span class="o">=</span> <span class="n">max</span> <span class="o">/</span> <span class="mi">2</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">while</span> <span class="n">int</span> <span class="o">!=</span> <span class="n">array_of_int</span><span class="o">[</span><span class="n">midpoint</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="n">int</span> <span class="o">&lt;</span> <span class="n">array_of_int</span><span class="o">[</span><span class="n">midpoint</span><span class="o">]</span>
</span><span class='line'>      <span class="n">max</span> <span class="o">=</span> <span class="n">midpoint</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="n">min</span> <span class="o">=</span> <span class="n">midpoint</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="n">midpoint</span> <span class="o">=</span> <span class="n">min</span> <span class="o">+</span> <span class="p">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">max</span> <span class="o">&lt;</span> <span class="n">min</span> <span class="o">||</span> <span class="n">min</span> <span class="o">&gt;</span> <span class="n">midpoint</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">midpoint</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>The Walkthrough</h2>

<h3>Edge Cases</h3>

<p>I implement the binary search routine using a while loop. I address the the edge case when the array is empty. When that hapens, I know that I must return <code>-1</code> because no integer will ever be present in an empty array.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">array_of_int</span><span class="o">.</span><span class="n">empty?</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Markers Point You In the Right Direction</h3>

<p>In this solution, I use markers to let me know what portion of the array I am focusing on. I start off by initializing my markers. I have a min marker which tells me the first element of the array, and I have a max marker which tells me the last element of the array. The midpoint marker tells me which index is the midpoint of the array. These markers will change during the course of the program as I search through smaller subsections of the array.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="n">min</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">array_of_int</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'>  <span class="n">midpoint</span> <span class="o">=</span> <span class="n">max</span> <span class="o">/</span> <span class="mi">2</span>
</span></code></pre></td></tr></table></div></figure>


<h3>The Search Is On</h3>

<p>Now comes the interesting part, the loop construct. I decided to use the while loop to iterate through the array because it was the first solution that came to mind. Only if I found the matching integer would I exit the while loop and return the index of the array in which I found the matching number.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">while</span> <span class="n">int</span> <span class="o">!=</span> <span class="n">array_of_int</span><span class="o">[</span><span class="n">midpoint</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Inside the while loop, I check for the condition where the integer I seek is less than the integer I find at the midpoint of the array. If it is less, then I move my max marker to 1 less than the midpoint; if more, then I move my min marker to 1 more than the midpoint. This is easily illustrated with a diagram.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">if</span> <span class="n">int</span> <span class="o">&lt;</span> <span class="n">array_of_int</span><span class="o">[</span><span class="n">midpoint</span><span class="o">]</span>
</span><span class='line'>  <span class="n">max</span> <span class="o">=</span> <span class="n">midpoint</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'>  <span class="n">min</span> <span class="o">=</span> <span class="n">midpoint</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice that with each iteration, I am focusing on a smaller portion of the array. After the if-else construct, I advance the midpoint marker to reflect the new midpoint for the smaller portion of the array that I am focusing on.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">midpoint</span> <span class="o">=</span> <span class="n">min</span> <span class="o">+</span> <span class="p">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span></code></pre></td></tr></table></div></figure>


<h3>When Markers Go Wrong</h3>

<p>Here is where it gets tricky. A strange thing happens when the integer is not present in the array: the max, min, and midpoint markers go berserk! They no longer begin to make sense. That&#8217;s when I know it&#8217;s time to jump out of the loop and return a <code>-1</code> to indicate that there was no matching integer inside the array.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">max</span> <span class="o">&lt;</span> <span class="n">min</span> <span class="o">||</span> <span class="n">min</span> <span class="o">&gt;</span> <span class="n">midpoint</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, the last line returns the index of the array that matched the integer I passed to the function.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="n">midpoint</span>
</span></code></pre></td></tr></table></div></figure>


<h2>A Final Note</h2>

<p>Don&#8217;t let my explanation fool you, this was a difficult exercise for me. At first I was thinking about chopping the array in half and then searching through each half iterating through each element one by one to see if I found the integer. That wasn&#8217;t the correct way to go about it; it would have been an incorrect implementation of a binary search. When you come across unfamiliar terms, you must start by understanding those terms before you can tackle a problem. My problem was that I didn&#8217;t understand the idea of a binary search.</p>

<p>This exercise took me somewhere close to 8 hours. I&#8217;m hoping to cut my time in half in the next implementation. Stick around as I try to solve this again using a different implementation.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/16/using-bundle-install-in-a-rails-3-generator/">Using &#8216;Bundle Install&#8217; in a Rails 3 Generator</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-10-16T00:04:00-07:00" pubdate  data-updated="true" >Oct 16<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/16/using-bundle-install-in-a-rails-3-generator/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Problem</h3>

<p>I came across Rails issue <a href="https://github.com/rails/rails/issues/3153">#3153</a> on Github which involved someone thinking <code>bundle install</code> didn&#8217;t work with Rails generators.</p>

<p>When working with Rails generators it&#8217;s important to remember that generators use Yehuda Katz&#8217;s Thor gem. The issue arose because the user tried to run the command <code>bundle install</code> from inside the directory in which the generator file had been created.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">SomegenGenerator</span> <span class="o">&lt;</span> <span class="no">Rails</span><span class="o">::</span><span class="no">Generators</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'> <span class="n">source_root</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s1">&#39;../templates&#39;</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'> <span class="k">def</span> <span class="nf">install</span>
</span><span class='line'>   <span class="n">gem</span> <span class="s2">&quot;unicorn&quot;</span>
</span><span class='line'>   <span class="n">run</span> <span class="s2">&quot;bundle install&quot;</span>
</span><span class='line'> <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Solution</h3>

<p>Again, the issue is that the command <code>bundle install</code> is being run from inside the directory <code>Issue3153/lib/generators/something/</code>. I&#8217;ll let you take a quick look at the Thor source code at <a href="https://github.com/wycats/thor/blob/master/lib/thor/actions.rb#L161">lib/thor/actions.rb</a>. As you have now seen, we can use the <code>inside</code> method to run the <code>bundle install</code> command from the root directory of our app Issue3153.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Issue3153/lib/generators/something/something_generator.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">SomethingGenerator</span> <span class="o">&lt;</span> <span class="no">Rails</span><span class="o">::</span><span class="no">Generators</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">source_root</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s1">&#39;../templates&#39;</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">install</span>
</span><span class='line'>    <span class="n">gem</span> <span class="s2">&quot;unicorn&quot;</span>
</span><span class='line'>    <span class="n">inside</span> <span class="no">Rails</span><span class="o">.</span><span class="n">root</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">run</span> <span class="s2">&quot;bundle install&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This now works!</p>

<h3>Take Aways</h3>

<ul>
<li>Rails generators use Thor Actions</li>
<li>The bundle install command must be run in the directory where the Gemfile of interest resides</li>
</ul>

</div>
  
  


    </article>
  
  <nav class="pagination">
    <div>
      
      <a href="/blog/archives">Blog Archives</a>
      
    </div>
  </nav>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2011/11/13/ruby-monk-problem-capitalizing-an-array-of-names/">Ruby Monk Problem - Capitalizing an Array of Names</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/11/11/karate-chop-code-kata-second-run/">Karate Chop Code Kata - Second Run</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/11/07/karate-chop-code-kata-first-run/">Karate Chop Code Kata - First Run</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/10/16/using-bundle-install-in-a-rails-3-generator/">Using &#8216;Bundle Install&#8217; in a Rails 3 Generator</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/dyba">@dyba</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'dyba',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("dyba", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/dyba" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @dyba</a>
  
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2011 - Daniel Dyba -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
    (function () {
      var disqus_shortname = 'danieldyba';
      
        
        var disqus_script = 'count.js'
      

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>







</body>
</html>
